version: 0.1
frontend:
    phases:
        preBuild:
            commands:
                - npm install
        build:
            commands:
                - npm run build
    artifacts:
        baseDirectory: .next
        files:
            - "**/*"
    cache:
        paths:
            - node_modules/**/*
            - ~/.cache
            - /root/.cache/Cypress

test:
    artifacts:
        baseDirectory: cypress
        configFilePath: "**/mochawesome.json"
        files:
            - "**/*.png"
            - "**/*.mp4"
    phases:
        preTest:
            commands:
                - npm install
                - npm install wait-on
                - "npm run dev & npx wait-on http://localhost:3000"
        test:
            commands:
                - npm run test
                - "npm run test:mocha-reporter"
        postTest:
            commands:
                - npm run test:mocha-report
